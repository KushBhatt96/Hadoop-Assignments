$HADOOP_HOME/bin/hadoop jar $HADOOP_HOME/share/hadoop/tools/lib/hadoop-streaming-2.7.6.jar -D mapred.output.key.comparator.class=org.apache.hadoop.mapred.lib.KeyFieldBasedComparator -D map.output.key.field.separator=, -D mapred.text.key.partitioner.options=-k1 -D mapred.text.key.comparator.options='-k1,1n -k2,2n' -D mapred.reduce.tasks=2 -input /user/matrix.txt -output /output_A2_Ex1/ -file mapper.py -file reducer.py -mapper mapper.py -reducer reducer.py -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner

hadoop fs -getmerge /output_A2_Ex1/ A2Ex1.out && cat A2Ex1.out | sort -k1,1n -k2,2n --field-separator="," > results.txt
