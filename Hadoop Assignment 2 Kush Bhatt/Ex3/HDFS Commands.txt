$HADOOP_HOME/bin/hadoop jar $HADOOP_HOME/share/hadoop/tools/lib/hadoop-streaming-2.7.6.jar -D map.output.key.field.separator=, -D mapred.text.key.partitioner.options=-k1,1 -D mapred.reduce.tasks=12 -input /user/retail.dat -output /output_A2_Ex3/ -file mapper.py -file reducer.py -mapper mapper.py -reducer reducer.py -partitioner org.apache.hadoop.mapred.lib.KeyFieldBasedPartitioner

hadoop fs -getmerge /output_A2_Ex3_M/ A2Ex3_final.out && cat A2Ex3_final.out | sort -k1,1n -k2,2n --field-separator="," > result_final.txt